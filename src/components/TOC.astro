---
// src/components/TOC.astro
type TocItem = { id: string; text: string; level: number };

const { toc, title = "目次", sticky = false } = Astro.props as {
  toc: TocItem[];
  title?: string;
  sticky?: boolean;
};

const levelClassMap: Record<number, string> = {
  2: "pl-0",
  3: "pl-4",
};
---

{toc?.length > 0 && (
  <div class={sticky ? "sticky top-24" : ""}>
    {/* Cloudflare寄せ：カード感を消して罫線のみ */}
    <nav aria-label="On this page" class="border-l border-gray-200 pl-4">
<h2 class="text-sm font-semibold mb-3 flex items-center gap-1">
  <span class="text-orange-500/80">{title}</span>
</h2>


      {/* 目次が長いときだけ、この中がスクロール */}
      <div class="max-h-[calc(100vh-6rem)] overflow-auto pr-2">
        <ul class="space-y-1 text-sm">
          {toc.map((item) => {
            const indent = levelClassMap[item.level] ?? "pl-0";
            return (
              <li class={indent}>
                <a
                  href={`#${item.id}`}
                  class="block text-gray-600 hover:text-orange-500 transition"
                >
                  {item.text}
                </a>
              </li>
            );
          })}
        </ul>
      </div>
    </nav>
  </div>
)}
