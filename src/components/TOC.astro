---
// src/components/TOC.astro
type TocItem = {
  id: string;
  text: string;
  level: number;
};

const { toc, title = "目次", sticky = false } = Astro.props as {
  toc: TocItem[];
  title?: string;
  sticky?: boolean;
};

// 型キャストをテンプレ内に持ち込まない（ここで用意）
const levelClassMap: Record<number, string> = {
  2: "ml-3",
  3: "ml-6",
};
---

{toc?.length > 0 && (
  <div>
    <div class="p-4 border border-gray-200 bg-gray-50 rounded-md shadow-sm">
      <h2 class="text-lg font-semibold text-gray-700 mb-2">{title}</h2>

      <ul class="space-y-1 text-sm text-gray-600 max-h-[calc(100vh-10rem)] overflow-auto pr-2">
        {toc.map((item) => {
          const levelClass = levelClassMap[item.level] ?? "";
          return (
            <li class={`pl-4 border-l-2 border-gray-300 ${levelClass}`}>
              <a href={`#${item.id}`} class="block hover:text-blue-500 transition">
                {item.text}
              </a>
            </li>
          );
        })}
      </ul>
    </div>
  </div>
)}
