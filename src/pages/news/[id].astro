---
import Layout from "@layouts/Layout.astro";
import { getNoticeDetail, getNoticeList, getSettings } from "@libs/microcms.ts";

export const prerender = true;

export async function getStaticPaths() {
  // まずは100件まで。超えたらページングで全件取得する
  const { contents } = await getNoticeList({ limit: 100 });
  return contents.map((n) => ({ params: { id: n.id } }));
}

const settings = await getSettings();
const { id } = Astro.params;

const notice = await getNoticeDetail(id!);

const Meta = {
  title: notice.title ?? "お知らせ",
  description: (notice.content ?? "").slice(0, 80),
};
---

<Layout Meta={Meta}>
  <div slot="main" class="w-full">
    <article class="prose prose-neutral max-w-none">
      <p class="text-sm text-gray-500">
        {notice.publishedAt?.slice(0, 10)}
      </p>

      <h1 class="text-3xl font-semibold leading-tight mt-2">
        {notice.title}
      </h1>

      <div
        class="entry-content prose prose-neutral max-w-none"
        set:html={notice.content ?? ""}
      />
    </article>
  </div>
</Layout>
